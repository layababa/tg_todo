📄 Telegram To-Do Mini App 产品需求文档 (PRD V2.1 - Notion 集成版)

核心定位：在 Telegram 群聊中即时沉淀任务，通过 Mini App 管理进度，并与 Notion Database 双向同步，确保每个参与者都能在熟悉的环境中完成协作。

一、产品概述

产品名称：Telegram To-Do Mini App with Notion

目标人群：活跃在 Telegram 的社群、项目组、协作团队，以及以 Notion 作为任务源的组织

核心价值：

在讨论现场秒级生成任务，不错过任何指派

Notion ↔ Telegram 双向同步，避免重复维护多个系统

Mini App 聚合「我被指派」与「我创建」的任务，随时掌握进度

关键触点：Telegram Bot、Telegram Mini App、Notion Database

部署要求：后端自托管（Docker）、前端发布到 Vercel 供 Telegram Mini App 调用

二、核心问题与解决路径

2.1 现状痛点

在只使用 Telegram 的情况下：

任务分散：讨论内容淹没在消息流里，无法形成统一任务视图

指派困难：需要不断 @ 成员，但缺少一份「谁负责什么」的清单

协作反馈缺失：完成状态、备注信息零散，相关人需重复确认

在只使用 Notion 的情况下：
4. 创建效率低：需要离开 Telegram 去 Notion 录入，打断当前讨论
5. 通知不对等：Notion 更新无法及时推送到 Telegram 用户
6. 上下文丢失：任务缺少原始讨论链接，新成员难以补齐背景

2.2 数据割裂的具体表现

Telegram Chat                        Notion Database
   ↓ 任务讨论                           ↓ 结构化任务
   ↓ 决策记录                           ↓ 状态、指派
   ↑ 没有实时同步  ←——  割裂  ——→  ↑ 其他人看不到


问题

在 Telegram 中的表现

在 Notion 中的表现

用户影响

信息不同步

成员已在群里完成任务

仍显示为「进行中」

管理者不了解真实进度

通知断裂

管理员在 Notion 评论

被指派人没有提醒

需要重复询问，效率低

创建割裂

需要立即记录

必须切换到 Notion

任务容易遗漏或重复

权限混乱

群内所有人都能看到

Notion 只有受邀者可见

新成员找不到任务来源

历史丢失

消息可能被删除

Notion 记录完整

资料分散，数据来源不一致

2.3 解决方案概述

问题

设计策略

Telegram ↔ Notion 数据割裂

建立双向同步通道：Bot 负责写入 Notion，通过定时轮询 (Polling) 监测 Notion 变化并触发 Telegram 提醒

创建效率低

在群聊里直接回复 (Reply) 消息即可生成任务，默认携带原始链接

通知不及时

所有关键状态（创建、指派、完成、评论）都会推送给相关人，并在 Mini App 实时更新

权限/上下文混乱

每个任务保留创建人、指派人、原始消息链接，并自动截取触发消息前的 10 条群聊记录作为上下文，在 Notion 中同步展示

个人视角缺失

Mini App 聚合「我的待办」，覆盖来自多个群聊和多个 Notion Database

三、用户角色与典型场景

角色

典型身份

核心诉求

关键触点

群主 / 发起人

社群主理人、项目经理

在讨论中快速沉淀任务、掌握整体进度

Telegram 群聊、Mini App、Notion 看板

被指派成员

研发、设计、运营

清楚自己的待办和截止时间，不遗漏提醒

Telegram 私聊通知、Mini App 列表、Notion 视图

Notion-first 成员

以 Notion 作为工作主场的人

在 Notion 中创建/更新任务即可触发 Telegram 推送

Notion Database、Bot 通知

新加入成员

新同事或协作者

快速了解群内已有任务与上下文

Bot 欢迎消息、Mini App 聚合页

典型场景：

临时项目：群内讨论一场活动，发起人随手引用消息并指派，任务自动同步到 Notion；线下同事可在 Notion 中继续编辑。

跨团队协作：不同团队在不同群聊和 Notion 数据库中协作，Mini App 统一展示「指派给我」的任务，减少信息重复。

社群运营：Bot 被拉进新群时会引导完成初始化，确保任务落在对应的 Notion Database，方便后续沉淀与复盘。

四、用户旅程与关键故事

4.1 故事 0：首次接触 & 账号初始化

用户在 Telegram 中首次 @Bot 或点击「Start」

Bot 发送欢迎消息，说明核心能力并附上「打开 Mini App」按钮

用户点击按钮进入 Mini App，系统基于 Telegram ID 自动生成账户，无需额外注册

若用户尚未绑定 Notion 账户，Mini App 提供「连接 Notion」与「稍后设置（离线模式）」两个选项

若选择「稍后设置」，用户可立即开始创建任务，数据将暂时存储在服务端/本地，待后续关联后同步

欢迎页展示「我被指派」「我创建」「全部」三类视图，引导完成首个任务创建

4.2 故事 G1：Bot 入群与群聊初始化

任意成员将 Bot 邀请进新的 Telegram 群聊

Bot 在群里发送引导消息：介绍能力 + 「为本群绑定 Notion 数据库」按钮（仅限群管理员操作）

群管理员点击按钮，打开 Mini App 中的「群组设置」页

权限校验与引导：

系统校验操作者是否为该群 Admin，若不是则提示无权操作

若是 Admin，页面提示：「请先在 Notion 中将目标 Database 分享 (Share) 给 Bot Integration」

管理员点击「刷新列表」，选择已授权的 Notion 数据库并确认

群聊成功绑定后，Bot 将初始化结果同步到群里，同时推送给管理员用于记录

4.3 故事 G2：新成员加入已配置的群聊

新成员加入群聊，Bot 自动发送简短欢迎和操作提示

新成员点击 Mini App，系统根据所在群聊展示对应的任务列表

若新成员尚未绑定 Notion 账户，Mini App 提示完成绑定，以便接收指派

新成员可以看到群内已有任务、指派人和原始消息，快速融入项目

注意：群成员拥有对该群关联任务的隐式读取权限，即使他们在 Notion 中没有直接权限，也能通过 Mini App 查看任务详情（上下文共享原则）。

4.4 故事 S1：回复消息快速给自己建任务

用户在讨论中看到需要记录的事项，对该消息点击「回复」(Reply)

在输入框中 @Bot，发送指令

Bot 立即生成任务，默认指派给操作者本人

Mini App 「我的任务」列表秒级出现该任务，并保留原始消息链接。同时，系统自动读取该消息之前的 10 条群聊记录，作为“上下文快照”存入任务详情，方便回溯讨论背景。

用户可在 Mini App 中补充字段、设定截止日期或分享到 Notion

4.5 故事 S2：回复消息并指派多人

发起人回复 (Reply) 群聊中的消息并 @Bot，同时 @需要协作的成员

Bot 解析被提及的成员身份，生成多人指派任务

每位被指派成员收到私聊通知及任务链接

异常处理：若某成员未曾启动过 Bot，Bot 无法发起私聊，将在群内回复：「@User 无法发送通知，请先私聊我点击 Start」。

Mini App 中「我被指派的任务」立即同步；Notion 中也可看到完整指派列表

4.6 故事 S3：任务进度更新

被指派成员在 Mini App 中打开任务详情，点击「标记完成」或「重新打开」

权限说明：采用协作模式，群内 Admin、任务创建人、指派人均有权修改状态。系统会记录「由谁修改」并在动态中展示。

系统更新状态并通知任务创建人及其他相关成员（操作者本人不再收到重复提醒）

Notion 中的状态同步更新，方便习惯在 Notion 工作的成员追踪

Mini App 会将任务移动到「已完成」或「待跟进」分组，保持视图整洁

4.7 故事 N1：在 Notion 中创建/指派任务

项目经理在 Notion 数据库中新建任务并指派给某位团队成员

系统侦测到新的任务页，自动推送 Telegram 私聊提醒给被指派者

映射检查：系统查找 Notion User 对应的 Telegram 账号。若未找到绑定记录，Bot 会在关联群组中发送公屏提示：「Notion 任务指派给了 @NotionUser，但他尚未绑定 Telegram，请提醒绑定。」

Mini App 中「我被指派」列表出现该任务，并展示来自 Notion 的字段（如优先级、截止日期）

任务创建人可在 Notion 中继续维护字段，同时 Telegram 内保持同步

4.8 故事 N2：在 Notion 中更新任务状态

成员在 Notion 中把任务状态从「进行中」改为「完成」

后端 在轮询周期内监测到 变更，并通知 Telegram 中的相关人

Mini App 列表将该任务移动到「已完成」分组，确保所有人为同一状态

如果状态被重新打开，同样会推送「任务已重新开放」提醒

4.9 故事 N3：双向评论协作

任意成员在 Notion 中发表评论，系统 监测到更新后，会推送给 Telegram 中的创建人及其他指派人

成员也可以在 Mini App 评论区补充说明、粘贴链接或 @ 同事

所有评论都会同步写入 Notion，并带有来源标记（由 Bot 代发，内容标注如「From Alice: ...」）

评论触发的通知遵循「相关人收到、操作者不重复提醒」的规则，保持信息干净

4.10 故事 S4：误操作与任务删除

用户发现刚才创建的任务有误，或任务已取消

在 Mini App 任务详情页底部点击「删除任务」（仅限创建人或 Admin）

系统弹出二次确认框，确认后执行软删除（Notion 中标记为 Archive 或特定状态，而非物理删除，防止误删）

群聊中 Bot 会更新原任务消息（若可编辑）或回复一条「任务已删除」的提示，避免其他人继续跟进

4.11 故事 G3：变更群组绑定的数据库

项目周期结束，群组进入下一阶段，管理员需要更换绑定的 Notion Database

管理员在 Mini App 群组设置页点击「解除绑定」或「更换数据库」

系统提示：「更换后，旧任务将不再同步到本群，新创建的任务将写入新库」

管理员完成新库的选择与授权流程（同 G1）

Bot 在群内通知：「本群数据源已切换至《新项目看板》」

4.12 故事 P1：每日待办摘要 (Daily Digest)

每天早上 9:00（用户可配置时间），Bot 向用户发送私聊推送

内容包含：「今日截止」、「已逾期」和「待处理」的任务概览

用户点击卡片直接打开 Mini App 查看详情，快速规划当天工作

4.13 故事 S5：通知直达与快速处理

用户收到 Bot 发送的“新任务指派”或“新评论”通知

通知卡片下方附带「📂 打开工单」按钮（Deep Link）

用户点击按钮，直接唤起 Mini App 并自动跳转到该任务的详情页

用户无需在列表中寻找，即可立即进行回复评论或变更状态的操作

4.14 故事 S6：溯源：从工单跳转回群聊上下文

用户在 Mini App 的任务列表中浏览，发现某个任务描述简略，想看当时的讨论背景

点击任务卡片上的「💬 跳转至对话」图标（Jump to Message）

Mini App 关闭，Telegram 自动定位到该任务创建时引用的那条原始消息

用户查看上下文后，可再次回复该消息唤起 Bot 进行补充，或直接在群里沟通

4.15 故事 S7：转发消息创建个人待办（Brainstormed）

用户在其他频道或私聊中看到一条重要信息，想存为待办

用户直接将该消息 转发 (Forward) 给 Bot

Bot 识别到转发内容，自动将其存为一条“个人收件箱”任务（默认不关联任何群组 Database，或存入用户个人绑定的默认库）

Bot 回复：「已保存到您的个人待办，点击查看详情」，方便用户后续整理

4.16 故事 S8：聚焦视图：按数据库筛选任务

首页默认展示聚合了所有来源的「我的待办」，但在处理特定项目时干扰较多

用户点击首页顶部的「来源/项目」筛选器

列表仅展示选定 Notion Database（如「Q4 营销活动」）下的任务

标题栏状态随之改变，帮助用户进入「单项目专注模式」

4.17 故事 S9：唤起 Notion App 进行深度编辑

用户在 Mini App 中浏览任务，发现需要编辑复杂的文档内容（如上传附件、写长文档）

点击详情页右上角的「Notion」图标

系统尝试唤起手机上安装的 Notion App 并直接打开该 Page（若未安装则打开浏览器）

用户在 Notion 原生 App 中完成重度编辑后，返回 Telegram 继续沟通

4.18 故事 M1：连接管理仪表盘

用户（特别是管理多个群组的 Admin）希望查看自己管理的所有群组与数据库的关联关系

在 Mini App 首页点击「设置」->「连接管理」

列表展示所有已绑定的「Telegram 群组 ↔ Notion Database」映射对

用户可在此处直接解绑、跳转到对应数据库，或检查同步状态（如 Token 是否过期）

4.19 故事 G4：智能选库与字段自动初始化

管理员进行群组绑定时，系统自动拉取 Bot 已获授权的所有 Database 列表（无需手动输入 ID）

管理员选择一个全新的 Database 后，系统自动检测是否包含必要字段（如 Status, Assignee, ChatLink）

若字段缺失，系统弹出「一键初始化」提示

管理员确认后，Bot 自动在 Notion Database 中创建缺失的 Property，确保后续同步无误

4.20 故事 U1：个人默认数据库配置

针对「转发创建」（故事 S7）的个人任务，用户希望指定一个默认存储位置

在 Mini App「个人设置」中，用户选择「默认个人数据库」

绑定成功后，所有转发给 Bot 的消息都会自动落入该库，无需每次选择

若未配置，转发时 Bot 会弹出选择框询问存入何处

4.21 故事 O1：离线/未关联模式下的任务创建

用户在未绑定 Notion 的情况下（离线模式），直接在 Mini App 或通过 Bot 指令创建任务

系统将任务持久化存储在 **Mini App 服务端数据库** 中，并将状态标记为「待同步至 Notion (Pending Notion Sync)」

Mini App 列表正常展示该任务，但会带有「Notion 未同步」的视觉标记（如 Notion 图标加斜杠或灰色状态点）

用户可以正常编辑任务标题、描述和状态，所有变更都会被记录在服务端

4.22 故事 O2：手动关联与数据同步

用户在「设置」页点击「连接 Notion」或手动输入 Notion Integration Key

系统验证 Key 有效性后，建立用户与 Notion 的关联

系统检测到有「待同步至 Notion」的历史任务，弹出提示：「发现 N 个任务尚未同步到 Notion，是否同步？」

用户确认后，系统引导用户选择目标 Database（或使用默认库）

所有仅存在于服务端的任务被批量写入 Notion，状态变更为「已同步」，并移除未同步标记

五、核心功能与体验架构

5.1 体验架构示意

┌────────────────────────────────────────┐
│                  Telegram Chat          │
│  ┌──────────────────────────────────┐   │
│  │ Bot 能力                         │   │
│  │ • 引用/回复/转发生成任务         │   │
│  │ • /set_notion_db 引导绑定        │   │
│  │ • 每日摘要与私聊通知             │   │
│  └──────────────────────────────────┘   │
└────────────────────────────────────────┘
          ↓ 创建与更新                         ↑ 通知
┌────────────────────────────────────────┐
│              应用服务层                   │
│  • 用户身份校验（基于 Telegram ID）      │
│  • 群聊 ↔ Notion Database 映射管理        │
│  • 任务与评论的同步队列                   │
│  • 智能选库与 Schema 自动初始化           │
│  • Mini App 配置下发                     │
└────────────────────────────────────────┘
          ↓ 写入与同步                         ↑ 查询与聚合
┌──────────────────────┐      ┌──────────────────────┐
│  Notion Database     │      │  Mini App            │
│  • 真实任务数据源     │      │  • 我的待办/我创建    │
│  • 多库多群管理       │      │  • 任务详情与评论    │
│  • 评论、状态、字段   │      │  • 连接管理与个人设置 │
│                       │      │  • 数据库筛选器      │
└──────────────────────┘      └──────────────────────┘


5.2 Mini App 关键页面

首页：

视图切换：我被指派 / 我创建 / 全部

筛选器：按 Notion Database 筛选任务（支持单项目专注模式）

列表项：展示状态、优先级、截止时间、来源群组

任务详情：

核心操作：完成/重开/删除（软删除）、跳转至对话（Jump to Chat）、唤起 Notion App

内容展示：富文本描述、评论区（支持 @Bot 代发）、上下文快照（自动抓取的 10 条历史消息）

设置页（新增）：

连接管理：查看我管理的群组与 Database 映射，支持解绑/换库

个人配置：设置「转发创建」的默认 Database

群组设置：仅在群聊环境下可见；用于智能选择 Database 并触发自动初始化

5.3 Bot 能力清单

在私聊中发送欢迎语、帮助信息、Mini App 快捷入口

消息处理：

群聊：识别回复 (Reply)、@ 指令、Topics 上下文

上下文抓取：创建任务时自动缓存触发消息前的 10 条群聊记录

私聊：识别 转发 (Forward) 消息并存入个人待办

主动服务：

每日 9:00 推送 Daily Digest（待办摘要）

推送带 Deep Link 的即时通知（直达工单页）

管理能力：

引导群聊完成 Notion Database 绑定（支持智能列表选择）

自动检测并修复 Database 缺少的字段 (Schema Auto-fix)

负责向相关人员推送状态变更、评论、新指派等提醒

5.4 Notion Database 的角色

作为所有任务的真实数据源（Source of Truth）

支持一个 Bot 服务多个群聊，每个群聊绑定不同的 Database

字段变化会被定期扫描，Mini App 动态适配字段（无需重新发布）

5.5 Bot 指令与交互详解

为了方便开发人员配置 BotFather 以及用户查阅，以下是标准指令清单：

A. 基础指令 (Commands)

指令

作用范围

描述

/start

私聊

启动 Bot，自动注册账号，发送欢迎语与 Mini App 入口

/help

全部

发送帮助文档链接和操作演示 GIF

/settings

私聊

快捷打开 Mini App 的「个人设置」页面

/bind

群聊

(仅管理员) 唤起「绑定数据库」的引导卡片

/todo

群聊

(可选) 显式创建任务前缀，等同于直接 @Bot

B. 自然语言交互 (NLP/Actions)

动作

场景

触发逻辑

@Bot + 文本

群聊

将文本识别为任务标题，创建新任务

Reply 消息 + @Bot

群聊

将被回复的消息作为任务上下文/引用，创建新任务

Forward 消息给 Bot

私聊

将转发的消息存入「个人默认数据库」

Bot 被拉入群组

群聊

触发 my_chat_member 事件，发送初始化引导

C. BotFather 配置建议

start - 开始使用 / 打开 Mini App
help - 查看使用帮助
settings - 个人设置
bind - (群组) 绑定 Notion 数据库


六、产品初始化与接入流程

6.1 准备工作（一次性）

在 Notion 后台创建一个 Integration，并赋予访问相关 Database 的权限

（可选）为每个 Telegram 群准备一个 Notion Database（若不准备，可使用 Bot 自动初始化功能）

将 Bot 发布到 Telegram，并在后台配置好 Notion Integration Token

6.2 群聊接入流程

Bot 被添加进群聊后，自动发送引导消息，提示需要绑定 Notion Database

群管理员点击按钮，打开 Mini App 群组设置页

智能绑定：系统列出 Bot 已获授权的所有 Database，管理员直接选择（无需填 ID）

若 Database 缺少必要字段，系统提示「一键初始化」，确认后自动补全 Schema

绑定成功后，群聊即可使用 Bot 创建任务；Mini App 也会记住群聊 ↔ Database 的映射

6.3 用户绑定流程

任意用户在私聊打开 Mini App 后，即基于 Telegram ID 自动创建账号

若用户尚未授权 Notion，系统会提示完成一次 OAuth 绑定，以便匹配 Notion User ID

绑定后，用户即可被指派、收到提醒、在 Notion 中查看到自己相关的任务

6.4 运行与运维

系统会定期扫描所有绑定的 Notion Database，自动适配新增字段

任意 Notion 任务的新增/修改/评论都会触发同步与通知

若绑定的 Database 权限失效，Bot 会提示群内尽快重新授权

七、数据流转与同步机制

7.1 数据流图

Telegram 用户动作
      ↓
Bot 捕获指令 → 应用服务层
      ↓                          ↘
写入 Notion Database             Mini App 配置/数据
      ↓                          ↗
同步状态与评论 ← Mini App 操作


关键说明：

Notion Database 是唯一的长期存储，Mini App 仅做聚合与操作入口

同一个 Bot 可以管理多个群聊，每个群聊维护一条 Database 映射

Mini App 使用缓存加速，但任何关键操作都会实时回写 Notion，确保一致性

7.2 同步节奏

即时：任务创建、指派、状态变更、评论→ 在秒级同步并推送提醒

轮询/监听：字段结构变化、Notion 侧批量更新→ 定时轮询 (Polling) 监测

补偿机制：若同步失败，系统会记录失败的任务并重试，同时向相关人提示

八、通知规范

8.1 触发场景

场景

被通知对象

文案示例

新任务指派

被指派成员

「Alice 为你创建了任务《API 文档编写》」

任务完成

创建人 + 其他指派成员

「Bob 已完成任务《API 文档编写》」

任务重新打开

创建人 + 所有指派成员

「Alice 重新打开了任务《API 文档编写》」

任务被删除

创建人 + 所有指派成员

「Charlie 删除了任务《API 文档编写》」

有新评论

创建人 + 其他指派成员

「Bob 评论：『初稿已完成，等待审核』」

每日摘要

所有已绑定用户

「早安！今日你有 3 个待办任务...」

8.2 推送规则

操作者本人不重复收到提醒

每条通知附带 Deep Link 按钮（如「📂 打开工单」），点击直达详情页

所有通知记录会写入日志，便于补偿或审计

九、成功标准

9.1 功能完成度

群聊中能一键生成任务并成功落库 Notion

Mini App 展示来自多个群聊的「我被指派」任务

Notion 中的更新会同步到 Telegram，并推送提醒

评论在 Telegram / Notion 之间保持一致

9.2 体验指标（V1）

Mini App 打开时间 < 2s（良好网络环境）

任务创建 → 推送通知延迟 < 5s

Notion 变更 → Telegram 通知延迟 < 2分钟 (受限于轮询频率)

用户完成指派 → 状态同步成功率 > 99%

新用户从首次接触到完成第一条任务创建 < 2 分钟

9.3 交付物

产品文档（本 PRD）

Bot & Mini App Demo

Notion 模板与接入指引

核心场景的录屏/动图

十、附录：常见问题（FAQ）

Q1：如果 Notion API 暂时不可用，Mini App 还能用吗？ A：可以。Mini App 依赖缓存展示已有任务，并会在后台重试同步操作。待 Notion 恢复后，失败的任务会自动补写。

Q2：每个群聊都需要配置 Notion Database 吗？ A：是的。Bot 会引导为每个群聊绑定一个 Database。不同群聊可以使用不同的 Database，便于隔离数据。

Q3：如何为群聊绑定 Database？ A：在群聊中点击 Bot 提供的「绑定 Notion 数据库」按钮，选择自己有权限的数据库即可。未来也可以在 Mini App 的群组设置中重新绑定。

Q8：并发冲突怎么处理？（比如两人同时修改同一个任务） A：采用“最后写入优先 (Last Write Wins)”策略。但为了减少冲突，Mini App 会在打开任务详情时强制拉取最新状态。如果 Notion 端发生了结构性改变（如删除了属性），Bot 会记录错误日志并尝试通过“自动修复”流程恢复，而不是直接崩溃。

Q9：如果 Notion 的 API 限流了怎么办？（Rate Limiting） A：系统需实现指数退避算法 (Exponential Backoff)。当触发 429 错误时，Bot 会暂停该 Database 的同步队列，并延迟重试。对于高频群组，建议适当降低轮询频率（如从 1分钟降为 5分钟）。

Q10：用户手动在 Notion 删除了必要字段（如 Status）会发生什么？ A：这是高危操作。Bot 在下一次同步或创建任务时会报错。系统会捕获此错误，并向群管理员发送“数据库结构异常”的警告，引导其进入 Mini App 进行“一键修复”（即重新创建缺失字段）。

Q11：如果用户更改了 Telegram Username 或 Notion Email，映射会失效吗？ A：不会。我们存储的是不可变的 Telegram User ID 和 Notion User ID。用户名或邮箱的变更不影响系统识别身份。

Q12：Bot 被踢出群组后，数据怎么处理？ A：Bot 会监听 my_chat_member 事件。一旦被踢出，系统将标记该群组的关联关系为“失效 (Inactive)”，停止轮询以节省资源。若 Bot 重新入群，需管理员手动在设置页“恢复连接”。

Q13：数据安全性如何保障？Bot Token 泄露怎么办？ A：Notion Access Token 是敏感信息，必须加密存储（如 AES-256）。且 Bot 仅申请必要的读写权限。建议每个群组使用独立的 Integration（虽然麻烦但隔离性好），或者使用官方推荐的 OAuth 模式，让用户授权给官方 Bot，而不是直接填 Token。

Q14：如果我在 Topic A 创建任务，Bot 会在 General 回复吗？ A：不会。Bot 严格遵循 Telegram Forum 逻辑，在哪个 message_thread_id 接收到的指令，就在哪个 Thread 回复。通知类消息也会尽可能发送到原 Thread，除非原 Thread 已被删除。

Q15：时区问题怎么解决？（我设置“明天截止”，是哪个时区的明天？） A：这是一个经典难题。Bot 会优先读取 Notion Workspace 的时区设置。如果获取不到，则默认使用 UTC+0 存储，并在 Mini App 端根据 用户手机本地时区 进行转换展示。在创建任务时，Bot 会尝试解析自然语言中的时区信息（如 "tomorrow 9am EST"）。

Q16：Telegram 里的图片和文件能同步到 Notion 吗？ A：不支持文件实体同步。为了避免版权、存储空间和 API 限制问题，系统仅会在 Notion 中存储 Telegram 消息的原始链接 (Message Link)。用户点击链接即可跳转回 Telegram 查看原文件。

Q17：Telegram 的 Markdown 和 Notion 的 Block 格式不兼容怎么办？ A：以 Notion 格式为准。

输入端：Telegram 发送的简单格式（粗体、链接）会尝试转换为 Notion Rich Text，无法转换的直接作为纯文本写入。

展示端：Mini App 内部直接渲染 Notion 的 Block/Rich Text 格式，不依赖 Telegram 的原生 Markdown 渲染逻辑，确保在 Mini App 中看到的样式与 Notion 原生 App 保持一致。

Q18：如果我在 Notion 里只有“评论权限”没有“编辑权限”，在 Mini App 能改状态吗？ A：不能。Mini App 的操作是代表 当前用户 执行的（如果绑定了个人 Token）。如果 Notion API 返回 403 Forbidden，Mini App 会弹窗提示“您在 Notion 端权限不足，无法修改”。若使用 Bot 统一身份写入，则不受此限制，但会牺牲审计精确度（见 Q13）。建议默认采用 Bot 统一写入 + 备注操作人 的方式以保证流畅体验。

Q19：如果 Notion Database 被意外删除或移动到了 Trash 会怎样？ A：Bot 在轮询时会收到 404 Not Found 或 Object Archived 错误。系统会自动暂停该群组的同步任务，并向群管理员发送“数据库丢失”的警报，提示重新绑定。系统不会自动解绑，以免只是暂时的网络波动或误操作。

Q20：如果用户在私聊中把 Bot 拉黑 (Block) 了，还能收到通知吗？ A：收不到。Telegram API 会返回 403 Forbidden: bot was blocked by the user。系统会捕获此错误，并在数据库中标记该用户为“不可达 (Unreachable)”，暂停对其发送通知，直到用户重新 Start Bot。建议在群里 @该用户 提示“请解除屏蔽以接收通知”。

Q21：如果 Database 里有 10,000+ 条任务，Mini App 会卡死吗？ A：不会，但需要分页策略。Mini App 默认仅加载“未完成”的任务，且每次只拉取最近的 50 条。搜索功能将依赖 Notion Search API 进行服务端检索，而不是前端全量过滤。

Q22：支持 Notion 的 Formula（公式）和 Rollup（汇总）字段吗？ A：仅支持读取，不支持编辑。Mini App 可以展示 Formula 计算出的结果（如“剩余天数”），但无法修改它。如果在 Mini App 中尝试编辑这些只读字段，UI 会置灰禁用。

Q4：用户需要做哪些准备？ A：只需在 Mini App 中完成一次 Notion 账户绑定。之后即可被指派、发表评论、接收通知，无需再登录其他系统。

Q5：未绑定 Notion 账户的用户可以使用吗？ A：可以。用户可以使用“离线模式”创建和管理任务。这些任务会暂时存储在本地/服务端。当用户后续绑定 Notion 账户（通过 OAuth 或手动输入 Key）后，可以手动触发同步，将历史任务写入 Notion。

Q6：能否同时服务多个群聊？ A：可以。同一个 Bot 可同时在多个群中工作，并为每个群建立独立的 Database 映射。Mini App 会按照个人视角汇总所有来源的任务。

Q7：评论和状态会不会重复通知？ A：不会。系统会识别操作者本人并避免重复提醒，只有其他相关人会收到推送。

Q23：自动抓取的 10 条上下文消息包含图片或文件吗？
A：仅包含文本内容。为了简化存储和展示，系统会过滤掉图片、视频和文件，仅保留文本消息。如果原消息是图片，上下文列表中会显示 [Image] 占位符。

最后更新：2025-01-20

版本：2.1（根据 V2.0 审查反馈修订）